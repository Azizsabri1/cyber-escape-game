<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Salle 3</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('partials/header') %>
  <main>
    <section class="card">
      <h2>Salle 3 â€“ La Crypte des Signatures Maudites</h2>
      <p>
        Cette salle utilise un jeton JWT pour dÃ©cider si tu peux ouvrir la porte.
        Il te faut un token avec :
      </p>
      <pre>{
  "role": "master",
  "level": 3
}</pre>
      <p>
        Ton token actuel (rÃ´le â€œplayerâ€) :
      </p>
      <pre><%= demoToken %></pre>

      <details>
        <summary>ğŸ’¡ Indice 1</summary>
        <p class="hint">
          Copie ce token dans <a href="https://jwt.io/" target="_blank">jwt.io</a>
          et regarde le payload. Que se passe-t-il si tu changes
          <code>role</code> et <code>level</code> ?
        </p>
      </details>

      <details>
        <summary>ğŸ’¡ Indice 2 (technique)</summary>
        <p class="hint">
          Le secret utilisÃ© pour signer les tokens est trÃ¨s faible (quelques
          caractÃ¨res). Si tu devines ou brute-force ce secret, tu peux re-signer
          un token avec les valeurs que tu veux.
        </p>
      </details>

      <details>
        <summary>ğŸ“˜ Explication de la faille</summary>
        <p class="hint">
          Cette salle illustre un problÃ¨me de <strong>JWT mal configurÃ©</strong> :
          secret trop court / faible. Un attaquant peut bricoler son propre token
          en forgeant un payload avec <code>role="master"</code> et
          <code>level=3</code>, puis le signer avec le mÃªme secret.
        </p>
        <p class="hint">
          <strong>Correctif :</strong> utiliser un secret long et alÃ©atoire,
          stockÃ© de maniÃ¨re sÃ©curisÃ©e ; limiter les algorithmes autorisÃ©s ;
          vÃ©rifier que le payload respecte bien une politique mÃ©tier stricte
          cÃ´tÃ© serveur (ne jamais faire confiance uniquement au contenu du token).
        </p>
      </details>
    </section>

    <section class="card">
      <h3>Soumettre un token JWT</h3>
      <form method="post" action="/room3">
        <label for="token">Ton token signÃ© :</label>
        <textarea id="token" name="token" rows="4" required></textarea>
        <button type="submit">Ouvrir la crypte</button>
      </form>
    </section>
  </main>
<%- include('partials/footer') %>
</body>
</html>
