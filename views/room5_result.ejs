<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Salle 5 â€“ RÃ©sultat</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<%- include('partials/header') %>
  <main>
    <section class="card">
      <h2>Salle 5 â€“ RÃ©sultat de la lecture</h2>
      <p>Fichier demandÃ© : <code><%= requested %></code></p>
      <p>Chemin rÃ©el sur le serveur :</p>
      <pre><%= targetPath %></pre>

      <% if (error) { %>
        <p>âŒ Erreur de lecture : <%= error %></p>
      <% } else { %>
        <h3>Contenu du fichier</h3>
        <pre><%= content %></pre>

        <% if (traversed) { %>
          <p>
            ğŸ‰ Tu as rÃ©ussi Ã  lire un fichier en dehors de
            <code>/secret</code> !<br>
            Tu as exploitÃ© une vulnÃ©rabilitÃ© de
            <strong>Path Traversal</strong>.
          </p>
        <% } else if (requested === 'flag-room5.txt') { %>
          <p>
            ğŸ‰ Tu as trouvÃ© le <code>flag-room5.txt</code> avec le flag.<br>
            Salle 5 vaincue !
          </p>
        <% } else { %>
          <p>
            â„¹ï¸ Tu as lu un fichier dans <code>/secret</code>, mais tu peux
            essayer de sortir du dossier avec un chemin contenant
            <code>../</code>.
          </p>
        <% } %>
      <% } %>

      <p><a href="/room5">Revenir Ã  la salle 5</a></p>
    </section>
  </main>
 <%- include('partials/footer') %>
</body>
</html>
